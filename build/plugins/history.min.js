!function(){function a(a){BOOMR.debug(a,"History")}function b(){function b(){BOOMR.window.addEventListener("popstate",function(b){a("popstate");c.routeChange()})}var d=BOOMR.window.history;"function"==typeof d.pushState&&(d.pushState=function(b){return function(d,e,f){a("pushState, title: "+e+" url: "+f);c.routeChange(e,f);return b.apply(this,arguments)}}(d.pushState));"function"==typeof d.replaceState&&(d.replaceState=function(b){return function(d,e,f){a("replaceState, title: "+e+" url: "+f);c.routeChange(e,f);return b.apply(this,arguments)}}(d.replaceState));"function"==typeof d.go&&(d.go=function(b){return function(d){a("go");c.routeChange();return b.apply(this,arguments)}}(d.go));"function"==typeof d.back&&(d.back=function(b){return function(){a("back");c.routeChange();return b.apply(this,arguments)}}(d.back));"function"==typeof d.forward&&(d.forward=function(b){return function(){a("forward");c.routeChange();return b.apply(this,arguments)}}(d.forward));BOOMR.window.addEventListener("hashchange",function(b){var d=(b||{}).newURL;a("hashchange "+d);c.routeChange(null,d)});BOOMR.hasBrowserOnloadFired()?b():BOOMR.window.addEventListener("load",function(){setTimeout(b,0)});BOOMR.subscribe("beacon",c.resetRouteChangeInProgress);BOOMR.subscribe("spa_cancel",c.resetRouteChangeInProgress);BOOMR.subscribe("spa_init",c.setRouteChangeInProgress);return!0}var c={auto:!1,enabled:!0,hooked:!1,routeHooked:!1,hadMissedRouteChange:!1,routeChangeInProgress:!1,disableHardNav:!1,resetRouteChangeInProgress:function(){a("resetting routeChangeInProgress");c.routeChangeInProgress&&clearTimeout(c.routeChangeInProgress);c.routeChangeInProgress=!1},setRouteChangeInProgress:function(){c.routeChangeInProgress&&clearTimeout(c.routeChangeInProgress);c.routeChangeInProgress=setTimeout(c.resetRouteChangeInProgress,50)},spaInit:function(a,b){b?BOOMR.fireEvent("spa_init",[BOOMR.plugins.SPA.current_spa_nav(),b]):a?BOOMR.fireEvent("spa_init",[BOOMR.plugins.SPA.current_spa_nav(),a]):BOOMR.fireEvent("spa_init",[BOOMR.plugins.SPA.current_spa_nav(),BOOMR.window.document.URL])},routeChange:function(b,d){if(c.enabled){if(c.disableHardNav&&!BOOMR.onloadFired())return;if(c.routeChangeInProgress)a("routeChangeInProgress, not triggering");else{a("routeChange triggered, sending route_change() event");c.spaInit(b,d);BOOMR.plugins.SPA.route_change()}}else{a("Not enabled - we've missed a routeChange");c.hadMissedRouteChange=!0;c.resetRouteChangeInProgress()}}};BOOMR=window.BOOMR||{};BOOMR.plugins=BOOMR.plugins||{};if(!BOOMR.plugins.History&&void 0!==BOOMR.plugins.SPA&&void 0!==BOOMR.plugins.AutoXHR&&BOOMR.window&&BOOMR.window.history){BOOMR.plugins.SPA.register("History");BOOMR.plugins.History={is_complete:function(){return!0},hook:function(a,d,e){e=e||{};e.disableHardNav=c.disableHardNav;if(c.hooked)return this;if(b()){BOOMR.plugins.SPA.hook(d,e);c.hooked=!0}return this},init:function(a){BOOMR.utils.pluginConfig(c,a,"History",["auto","enabled","disableHardNav"]);c.auto&&c.enabled&&this.hook(void 0,!0,{});return this},disable:function(){c.enabled=!1;return this},enable:function(){c.enabled=!0;if(c.hooked&&c.hadMissedRouteChange){c.hadMissedRouteChange=!1;BOOMR.plugins.SPA.route_change();c.setRouteChangeInProgress();a("Hooked and hadMissedRouteChange sending route_change!")}return this}}}}();
//# sourceMappingURL=history.min.js.map